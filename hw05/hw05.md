---
title: 'HW05: Factors & Figures'
author: "Avril Metcalfe-Roach"
date: "10/13/2019"
output: 
  html_document:
    keep_md: true
    toc: true
---






## Exercise 1: `here` Package Value

The `here` package (documented [here](https://www.rdocumentation.org/packages/here/versions/0.1)) is an innovative solution to sharing project files across different file locations and operating systems. 

By automatically determining the 'root' directory of a project, it bypasses the need to specify the exact file path for each element included in the code. This allows the project files to be easily moved to different locations around the computer or shared between users, and makes the code more legible by inlcuding only the file name in the written code. It also bridges the gap between different operating systems; instead of changing between forward and back slashes to convert file paths between Windows and Mac, one simply inputs the file name in quotations, leaving the parsing to the R package.

The `here` package is also easy to use. Once the package is loaded, any subfolders beyond the root directory (as defined by `here()`) are called by simply putting the name in quotations. The desired file is then called at the end in quotations. For example, if the project file is stored in the `here()` root directory, then a *file.jpeg* stored in *subfolder* can be accessed like so:

`here('subfolder','file.jpeg')`

This format can also be used to save new files.

Other perks of the `here` package are that it initializes a dedicated, local working directory for the code at hand, so that all items are cleared from the workspace. It also overrides the local working directory that is created by Rmd, which would otherwise cause relative path commands to fail.

## Exercise 2: Factor Management

#### Dataset: `gapminder`
#### Variable: `continent`

In this exercise, the above variable will be identified as a factor


```r
# Drop all entries in Africa:
no_a <- filter(gapminder, continent != 'Africa') %>% 
  droplevels()

gap_coun <- gapminder$country
noa_coun <- no_a$country

# Data information before dropping levels:
Class <- class(gap_coun) # Class of country column
Levels <- nlevels(gap_coun) # The number of different values of country
Rows <- nrow(gapminder) # Number of gapminder rows before factor mods
gap_info <- c(Class, Levels, Rows)

# Data information after dropping levels:
Class <- class(noa_coun) # Class of country column
Levels <- nlevels(noa_coun) # The number of different values of country
Rows <- nrow(no_a) # Number of gapminder rows after factor mods
noa_info <- c(Class, Levels, Rows)

# Comparison table:
Values <- c('Class', 'Levels', 'Rows')
tibble::tibble(Variable = Values,
               Pre = gap_info,
               Post = noa_info) %>% 
  knitr::kable()
```



Variable   Pre      Post   
---------  -------  -------
Class      factor   factor 
Levels     142      90     
Rows       1704     1080   

```r
str(gap_coun) 
```

```
##  Factor w/ 142 levels "Afghanistan",..: 1 1 1 1 1 1 1 1 1 1 ...
```

```r
str(noa_coun) 
```

```
##  Factor w/ 90 levels "Afghanistan",..: 1 1 1 1 1 1 1 1 1 1 ...
```


```r
# Pre-reordering:

# 1. Arrange based on gdpPercap, year:
pre <- gapminder %>% 
  filter(year == 2007) %>% 
  group_by(continent) %>% 
  mutate('% SD 2007' = sd(gdpPercap)/mean(gdpPercap)) %>%
  mutate_at(vars(`% SD 2007`),funs(round(.,3))) %>% 
  ungroup() %>% 
  arrange(-`% SD 2007`,-gdpPercap)

post <- no_a %>% 
  filter(year == 2007) %>% 
  group_by(continent) %>% 
  mutate('% SD 2007' = sd(gdpPercap)/mean(gdpPercap)) %>%
  mutate_at(vars(`% SD 2007`),funs(round(.,3))) %>% 
  ungroup() %>% 
  arrange(-`% SD 2007`,-gdpPercap)

DT::datatable(pre)
```

<!--html_preserve--><div id="htmlwidget-9e7667f7339d57e47e1c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9e7667f7339d57e47e1c">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142"],["Gabon","Botswana","Equatorial Guinea","Libya","Mauritius","South Africa","Reunion","Tunisia","Algeria","Egypt","Namibia","Angola","Swaziland","Morocco","Congo, Rep.","Sudan","Djibouti","Cameroon","Nigeria","Mauritania","Senegal","Chad","Sao Tome and Principe","Lesotho","Cote d'Ivoire","Kenya","Benin","Ghana","Zambia","Burkina Faso","Tanzania","Uganda","Madagascar","Mali","Comoros","Guinea","Somalia","Togo","Rwanda","Sierra Leone","Mozambique","Malawi","Gambia","Central African Republic","Ethiopia","Eritrea","Niger","Guinea-Bissau","Zimbabwe","Burundi","Liberia","Congo, Dem. Rep.","Kuwait","Singapore","Hong Kong, China","Japan","Bahrain","Taiwan","Israel","Korea, Rep.","Oman","Saudi Arabia","Malaysia","Iran","Lebanon","Thailand","China","Jordan","Iraq","Syria","Sri Lanka","Indonesia","Philippines","Mongolia","West Bank and Gaza","Pakistan","India","Vietnam","Yemen, Rep.","Cambodia","Korea, Dem. Rep.","Bangladesh","Nepal","Afghanistan","Myanmar","United States","Canada","Puerto Rico","Trinidad and Tobago","Chile","Argentina","Mexico","Venezuela","Uruguay","Panama","Costa Rica","Brazil","Cuba","Peru","Jamaica","Colombia","Ecuador","Dominican Republic","El Salvador","Guatemala","Paraguay","Bolivia","Honduras","Nicaragua","Haiti","Norway","Ireland","Switzerland","Netherlands","Iceland","Austria","Denmark","Sweden","Belgium","Finland","United Kingdom","Germany","France","Spain","Italy","Greece","Slovenia","Czech Republic","Portugal","Slovak Republic","Hungary","Poland","Croatia","Romania","Bulgaria","Serbia","Montenegro","Turkey","Bosnia and Herzegovina","Albania","Australia","New Zealand"],["Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Africa","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Oceania","Oceania"],[2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007],[56.735,50.728,51.579,73.952,72.801,49.339,76.442,73.923,72.301,71.338,52.906,42.731,39.613,71.164,55.322,58.556,54.791,50.43,46.859,64.164,63.062,50.651,65.528,42.592,48.328,54.11,56.728,60.022,42.384,52.295,52.517,51.542,59.443,54.467,65.152,56.007,48.159,58.42,46.242,42.568,42.082,48.303,59.448,44.741,52.947,58.04,56.867,46.388,43.487,49.58,45.678,46.462,77.588,79.972,82.208,82.603,75.635,78.4,80.745,78.623,75.64,72.777,74.241,70.964,71.993,70.616,72.961,72.535,59.545,74.143,72.396,70.65,71.688,66.803,73.422,65.483,64.698,74.249,62.698,59.723,67.297,64.062,63.785,43.828,62.069,78.242,80.653,78.746,69.819,78.553,75.32,76.195,73.747,76.384,75.537,78.782,72.39,78.273,71.421,72.567,72.889,74.994,72.235,71.878,70.259,71.752,65.554,70.198,72.899,60.916,80.196,78.885,81.701,79.762,81.757,79.829,78.332,80.884,79.441,79.313,79.425,79.406,80.657,80.941,80.546,79.483,77.926,76.486,78.098,74.663,73.338,75.563,75.748,72.476,73.005,74.002,74.543,71.777,74.852,76.423,81.235,80.204],[1454867,1639131,551201,6036914,1250882,43997828,798094,10276158,33333216,80264543,2055080,12420476,1133066,33757175,3800610,42292929,496374,17696293,135031164,3270065,12267493,10238807,199579,2012649,18013409,35610177,8078314,22873338,11746035,14326203,38139640,29170398,19167654,12031795,710960,9947814,9118773,5701579,8860588,6144562,19951656,13327079,1688359,4369038,76511887,4906585,12894865,1472041,12311143,8390505,3193942,64606759,2505559,4553009,6980412,127467972,708573,23174294,6426679,49044790,3204897,27601038,24821286,69453570,3921278,65068149,1318683096,6053193,27499638,19314747,20378239,223547000,91077287,2874127,4018332,169270617,1110396331,85262356,22211743,14131858,23301725,150448339,28901790,31889923,47761980,301139947,33390141,3942491,1056608,16284741,40301927,108700891,26084662,3447496,3242173,4133884,190010647,11416987,28674757,2780132,44227550,13755680,9319622,6939688,12572928,6667147,9119152,7483763,5675356,8502814,4627926,4109086,7554661,16570613,301931,8199783,5468120,9031088,10392226,5238460,60776238,82400996,61083916,40448191,58147733,10706290,2009245,10228744,10642836,5447502,9956108,38518241,4493312,22276056,7322858,10150265,684736,71158647,4552198,3600523,20434176,4115771],[13206.48452,12569.85177,12154.08975,12057.49928,10956.99112,9269.657808,7670.122558,7092.923025,6223.367465,5581.180998,4811.060429,4797.231267,4513.480643,3820.17523,3632.557798,2602.394995,2082.481567,2042.09524,2013.977305,1803.151496,1712.472136,1704.063724,1598.435089,1569.331442,1544.750112,1463.249282,1441.284873,1327.60891,1271.211593,1217.032994,1107.482182,1056.380121,1044.770126,1042.581557,986.1478792,942.6542111,926.1410683,882.9699438,863.0884639,862.5407561,823.6856205,759.3499101,752.7497265,706.016537,690.8055759,641.3695236,619.6768924,579.231743,469.7092981,430.0706916,414.5073415,277.5518587,47306.98978,47143.17964,39724.97867,31656.06806,29796.04834,28718.27684,25523.2771,23348.13973,22316.19287,21654.83194,12451.6558,11605.71449,10461.05868,7458.396327,4959.114854,4519.461171,4471.061906,4184.548089,3970.095407,3540.651564,3190.481016,3095.772271,3025.349798,2605.94758,2452.210407,2441.576404,2280.769906,1713.778686,1593.06548,1391.253792,1091.359778,974.5803384,944,42951.65309,36319.23501,19328.70901,18008.50924,13171.63885,12779.37964,11977.57496,11415.80569,10611.46299,9809.185636,9645.06142,9065.800825,8948.102923,7408.905561,7320.880262,7006.580419,6873.262326,6025.374752,5728.353514,5186.050003,4172.838464,3822.137084,3548.330846,2749.320965,1201.637154,49357.19017,40675.99635,37506.41907,36797.93332,36180.78919,36126.4927,35278.41874,33859.74835,33692.60508,33207.0844,33203.26128,32170.37442,30470.0167,28821.0637,28569.7197,27538.41188,25768.25759,22833.30851,20509.64777,18678.31435,18008.94444,15389.92468,14619.22272,10808.47561,10680.79282,9786.534714,9253.896111,8458.276384,7446.298803,5937.029526,34435.36744,25185.00911],[1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.171,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.219,0.219]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>country<\/th>\n      <th>continent<\/th>\n      <th>year<\/th>\n      <th>lifeExp<\/th>\n      <th>pop<\/th>\n      <th>gdpPercap<\/th>\n      <th>% SD 2007<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

```r
DT::datatable(post)
```

<!--html_preserve--><div id="htmlwidget-1960f491789f4a37e6a8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1960f491789f4a37e6a8">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90"],["Kuwait","Singapore","Hong Kong, China","Japan","Bahrain","Taiwan","Israel","Korea, Rep.","Oman","Saudi Arabia","Malaysia","Iran","Lebanon","Thailand","China","Jordan","Iraq","Syria","Sri Lanka","Indonesia","Philippines","Mongolia","West Bank and Gaza","Pakistan","India","Vietnam","Yemen, Rep.","Cambodia","Korea, Dem. Rep.","Bangladesh","Nepal","Afghanistan","Myanmar","United States","Canada","Puerto Rico","Trinidad and Tobago","Chile","Argentina","Mexico","Venezuela","Uruguay","Panama","Costa Rica","Brazil","Cuba","Peru","Jamaica","Colombia","Ecuador","Dominican Republic","El Salvador","Guatemala","Paraguay","Bolivia","Honduras","Nicaragua","Haiti","Norway","Ireland","Switzerland","Netherlands","Iceland","Austria","Denmark","Sweden","Belgium","Finland","United Kingdom","Germany","France","Spain","Italy","Greece","Slovenia","Czech Republic","Portugal","Slovak Republic","Hungary","Poland","Croatia","Romania","Bulgaria","Serbia","Montenegro","Turkey","Bosnia and Herzegovina","Albania","Australia","New Zealand"],["Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Asia","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Americas","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Europe","Oceania","Oceania"],[2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007,2007],[77.588,79.972,82.208,82.603,75.635,78.4,80.745,78.623,75.64,72.777,74.241,70.964,71.993,70.616,72.961,72.535,59.545,74.143,72.396,70.65,71.688,66.803,73.422,65.483,64.698,74.249,62.698,59.723,67.297,64.062,63.785,43.828,62.069,78.242,80.653,78.746,69.819,78.553,75.32,76.195,73.747,76.384,75.537,78.782,72.39,78.273,71.421,72.567,72.889,74.994,72.235,71.878,70.259,71.752,65.554,70.198,72.899,60.916,80.196,78.885,81.701,79.762,81.757,79.829,78.332,80.884,79.441,79.313,79.425,79.406,80.657,80.941,80.546,79.483,77.926,76.486,78.098,74.663,73.338,75.563,75.748,72.476,73.005,74.002,74.543,71.777,74.852,76.423,81.235,80.204],[2505559,4553009,6980412,127467972,708573,23174294,6426679,49044790,3204897,27601038,24821286,69453570,3921278,65068149,1318683096,6053193,27499638,19314747,20378239,223547000,91077287,2874127,4018332,169270617,1110396331,85262356,22211743,14131858,23301725,150448339,28901790,31889923,47761980,301139947,33390141,3942491,1056608,16284741,40301927,108700891,26084662,3447496,3242173,4133884,190010647,11416987,28674757,2780132,44227550,13755680,9319622,6939688,12572928,6667147,9119152,7483763,5675356,8502814,4627926,4109086,7554661,16570613,301931,8199783,5468120,9031088,10392226,5238460,60776238,82400996,61083916,40448191,58147733,10706290,2009245,10228744,10642836,5447502,9956108,38518241,4493312,22276056,7322858,10150265,684736,71158647,4552198,3600523,20434176,4115771],[47306.98978,47143.17964,39724.97867,31656.06806,29796.04834,28718.27684,25523.2771,23348.13973,22316.19287,21654.83194,12451.6558,11605.71449,10461.05868,7458.396327,4959.114854,4519.461171,4471.061906,4184.548089,3970.095407,3540.651564,3190.481016,3095.772271,3025.349798,2605.94758,2452.210407,2441.576404,2280.769906,1713.778686,1593.06548,1391.253792,1091.359778,974.5803384,944,42951.65309,36319.23501,19328.70901,18008.50924,13171.63885,12779.37964,11977.57496,11415.80569,10611.46299,9809.185636,9645.06142,9065.800825,8948.102923,7408.905561,7320.880262,7006.580419,6873.262326,6025.374752,5728.353514,5186.050003,4172.838464,3822.137084,3548.330846,2749.320965,1201.637154,49357.19017,40675.99635,37506.41907,36797.93332,36180.78919,36126.4927,35278.41874,33859.74835,33692.60508,33207.0844,33203.26128,32170.37442,30470.0167,28821.0637,28569.7197,27538.41188,25768.25759,22833.30851,20509.64777,18678.31435,18008.94444,15389.92468,14619.22272,10808.47561,10680.79282,9786.534714,9253.896111,8458.276384,7446.298803,5937.029526,34435.36744,25185.00911],[1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,1.135,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.883,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.471,0.219,0.219]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>country<\/th>\n      <th>continent<\/th>\n      <th>year<\/th>\n      <th>lifeExp<\/th>\n      <th>pop<\/th>\n      <th>gdpPercap<\/th>\n      <th>% SD 2007<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->


```r
# Pre-reordering:
no_reorder <- post %>% 
  ggplot(aes(x=continent, 
             y=`% SD 2007`, 
             fill = continent)) +
  geom_col() +
  xlab('Continent') +
  ylab('% Std Dev of GDP per Capita in 2007') +
  ggtitle('Not Reordered') +
  scale_fill_discrete(name = "Continent") +
  ggthemes::theme_tufte() +
  theme(legend.position='none')
  

# Continents ordered from min to max % SD:
reorder <- post %>% 
  ggplot(aes(x=fct_reorder(continent,`% SD 2007`,min), 
             y=`% SD 2007`, 
             fill = continent)) +
  geom_col() +
  xlab('Continent') +
  ylab('% Std Dev of GDP per Capita in 2007') +
  ggtitle('Reordered (Min to Max)') +
  scale_fill_discrete(name = "Continent") +
  ggthemes::theme_tufte()

# Creating one common legend (see References):
shared_legend<-function(p){
  temp <- ggplot_gtable(ggplot_build(p))
  L <- which(sapply(temp$grobs, function(x) x$name) == "guide-box")
  f_leg <- temp$grobs[[L]]
  return(f_leg)}

leg<-shared_legend(reorder)

# Arrange into side by side plots:
require(gridExtra) # Arrange them side by side
gridExtra::grid.arrange(no_reorder,reorder + theme(legend.position='none'), leg, ncol=3)
```

![](hw05_files/figure-html/reordering-1.png)<!-- -->

### References

A common legend was created for the Total GDP graphs by using the code provided by **[Roland](https://stackoverflow.com/users/1412059/roland)** on [StackOverflow](https://stackoverflow.com/questions/13649473/add-a-common-legend-for-combined-ggplots

